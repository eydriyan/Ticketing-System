<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Ticketing System</title>
	<link href='https://fonts.googleapis.com/css?family=Jomhuria' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar">
    <img src="../../assets/images/systemicon.png" alt="Ticketing System Icon" class="systemIcon">
    <div class="title">IT Ticketing System</div>
    <button class="Btn" (click)="logout()">
        <div class="sign"><svg viewBox="0 0 512 512"><path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"></path></svg></div>
        <div class="text">Logout</div>
      </button>
</nav>
<!--Left Container for Profile, Dashboard and History-->   
<div class="leftcontainer">
	<div class="profile-container" onclick="location.href='/adminprofile';">
	  <img src="/assets/images/tempprofile.png" alt="Profile" class="tempprofile">
	  <div class="userdata">
		<h4>{{ user?.firstName }} {{ user?.lastName }}</h4>
		<h4>{{ user?.role }}</h4>
	  </div>
	</div>
	<div class="line-division"></div>
	<div class="buttons-nav">
	  <a onclick="window.location.href='admindashboard'">
		  <img src="../../assets/images/dashboardButton.png" class="dashboard" alt="Dashboard">
	  </a>
	  <a onclick="window.location.href='adminhistory'">
		  <img src="../../assets/images/historyButton.png" class="history" alt="History">
	  </a>
	  <a onclick="window.location.href='adminanalytics'">
		  <img src="../../assets/images/analyticsButton.png" class="analytics" alt="Analytics">
	  </a>
	<a onclick="window.location.href='managetechnician'">
				<img src="../../assets/images/Technician.png" class="managetechnician" alt="managetechnician">
		</a>
		<a onclick="window.location.href='manageuser'">
			<img src="../../assets/images/User.png" class="manageuser" alt="manageuser">
		</a> 
	  </div>
  </div>
 
<!-- (logo)Ticket Requests(Title) - (Button)Filter - (Searchbar)-->  
	   <div class="rightcontainer">
			<table >
		  <tr>
			<td class="title-container">
				<img src="../../assets/images/analyticsButton.png" class="analytics" alt="Analytics">
			</td>
			
		  </tr>
		</table>
	
		
<!-- table for analytics-->
<div>
    <canvasjs-chart [options]="ticketStatusChart"></canvasjs-chart>
</div>
<br><br>
<div>
    <canvasjs-chart [options]="ticketResolvedByCategory"></canvasjs-chart>
</div>
<br> <br>
	<h2>Top Performing Technicians</h2>
	<div class="analytics-table">
			<table class="technician">
                    <tr *ngFor="let technician of technicians; let i = index" class="technicianRow">
                        <th class="rankCol">{{ i + 1 }}</th>
                        <th class="pictureCol infoCol"><img class="pictureTechnician"  src="/assets/images/tempprofile.png">{{ technician.firstName }} {{ technician.lastName }}</th>
                        <th class="infoCol">{{ technician.email }}</th>
                        <th class="infoCol">{{ resolvedTicketsMap[technician.id] || 0 }}</th>
                        <th></th>
                    </tr>
			</table>
    </div>
</div>

<!-- FOR FORMS handling of modals -->
<script>
	// Function to display the modal
	function displayModal(modalId) {
		var modals = document.querySelectorAll('.modal');
		modals.forEach(function(modal) {
			modal.style.display = "none";
		});
		var modal = document.getElementById(modalId);
		if (modal) {
			modal.style.display = "block";
		}
	}

	// Function to close the Add Ticket Form modal
	function closeModal() {
		var modal = document.getElementById('update-form-container');
		if (modal) {
			modal.style.display = "none";
		}
	}

	// Function to close the Filter Form modal
	function closeFilterModal() {
		var modal = document.getElementById('Filter-form-container');
		if (modal) {
			modal.style.display = "none";
		}
	}

	// When the user clicks anywhere outside of the modal, close it
	window.onclick = function(event) {
		var modals = document.querySelectorAll('.modal');
		modals.forEach(function(modal) {
			if (event.target == modal) {
				modal.style.display = "none";
			}
		});
	}
</script>


<script>
// JavaScript to set the current date in the "Date Created" input field
document.addEventListener("DOMContentLoaded", function() {
var currentDate = new Date().toISOString().split('T')[0];
document.getElementById('date-created').value = currentDate;
});
</script>

<!--For Filter Ticket-->

<script>
function getCurrentDate(offset) {
const currentDate = new Date();
const year = currentDate.getFullYear() + (parseInt(offset) || 0);
const month = String(currentDate.getMonth() + 1).padStart(2, '0');
const day = String(currentDate.getDate()).padStart(2, '0');
return `${year}/${month}/${day}`;
}

document.addEventListener("DOMContentLoaded", function() {
const dateInput = document.getElementById('date-created');
dateInput.value = getCurrentDate();
});
</script>

</body>
</html>
